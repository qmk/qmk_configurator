import{n as _,d as p,e as o,f as m,i as c,D as n}from"./index-9nugsIOj.js";const S={name:"base-keymap",computed:{styles(){let e=.85,t=.61;return this.config.SCALE<1&&(e*=(1+this.config.SCALE)/2,t*=(1+this.config.SCALE)/2),{"--unit-width":"1","--unit-height":"1","--default-smaller-key-font-size":`${t}rem`,"--default-key-font-size":`${e}rem`,"--default-key-height":`${this.config.KEY_HEIGHT}px`,"--default-key-width":`${this.config.KEY_WIDTH}px`,"--default-key-x-spacing":`${this.config.KEY_X_SPACING}px`,"--default-key-y-spacing":`${this.config.KEY_Y_SPACING}px`,width:`${this.width}px`,height:`${this.height}px`}}},methods:{calcKeyKeymapDims(e,t){return{w:e*this.config.KEY_X_SPACING-(this.config.KEY_X_SPACING-this.config.KEY_WIDTH),h:t*this.config.KEY_Y_SPACING-(this.config.KEY_Y_SPACING-this.config.KEY_HEIGHT),uh:t,uw:e}},calcKeyKeymapPos(e,t){return{x:e*this.config.KEY_X_SPACING,y:t*this.config.KEY_Y_SPACING}},setSize(e){this.width=e.x,this.height=e.y},calculateMax(e){const s=this.layouts[e].reduce((i,a)=>{let r=Object.assign({w:1,h:1},a);const l=this.calcKeyKeymapPos(r.x,r.y),d=this.calcKeyKeymapDims(r.w,r.h);return i.x=Math.max(i.x,l.x+d.w),i.y=Math.max(i.y,l.y+d.h),i},{x:0,y:0});return s.x>this.defaults.MAX_X&&(this.resizeConfig(s),s.x*=this.config.SCALE,s.y*=this.config.SCALE),s}}};let k,w;const y={};var v=_(S,k,w,!1,K);function K(e){for(let t in y)this[t]=y[t]}const A=function(){return v.exports}();var x=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"key",class:e.myclasses,style:e.mystyles,attrs:{draggable:"",id:e.myid,title:e.myTitle},on:{click:e.clicked,dragstart:e.dragstart,dragend:e.dragend,drop:function(i){return i.stopPropagation(),e.dropped.apply(null,arguments)},dragleave:function(i){return i.preventDefault(),e.dragleave.apply(null,arguments)},dragover:function(i){return i.preventDefault(),e.dragover.apply(null,arguments)},dragenter:function(i){return i.preventDefault(),e.dragenter.apply(null,arguments)}}},[e._v(e._s(e.displayName)),e.icon?s("font-awesome-icon",{attrs:{size:"2x",icon:e.icon}}):e._e(),e.visible?[e.visible?s("div",{staticClass:"remove",on:{click:function(i){return i.stopPropagation(),e.remove.apply(null,arguments)}}},[s("font-awesome-icon",{attrs:{icon:"times",size:"xs"}})],1):e._e()]:e._e()],2)},$=[];let h=Object.assign({},n.iconCodes,n.platformIcons(window.navigator.platform));const C=(e,t)=>{if(e==1)switch(t){case 1:return"k1u";case 1.25:return"k125u";case 1.5:return"k15u";case 1.75:return"k175u";case 2:return"k2u";case 2.25:return"k225u";case 2.75:return"k275u";case 3:return"k3u";case 4:return"k4u";case 6:return"k6u";case 6.25:return"k625u";case 7:return"k7u"}if(t==1)switch(e){case 1.25:return"k125uh";case 1.5:return"k15uh";case 1.75:return"k175uh";case 2:return"k2uh"}if(e===2){if(t===1.25)return"kiso";if(t===1.5)return"kbae"}return"custom"},u=new Map,f=(e,t)=>{const s=`${e}-${t}`;if(u.has(s))return u.get(s);const a=C(e,t);return u.set(s,a),a},E={name:"base-key",props:{id:Number,meta:Object,w:Number,h:Number,y:Number,x:Number,uh:Number,uw:Number,colorway:String,legends:{type:String,default:"keymap"},matrix:Array,printable:{type:Boolean,default:!1}},computed:{...o("keymap",["config"]),...o("keymap",{curLayer:"layer"}),...m("keymap",["getKey","getSelectedKey","colorwayOverride"]),...m("keycodes",["lookupKeycode"]),...o("app",["configuratorSettings"]),myTitle(){return this.meta?this.meta.code:""},myid(){return`key-${this.id}`},visible(){return this.meta?this.meta.code!=="KC_NO":!1},displayName(){switch(this.legends){case"size":{const{uh:e,uw:t}=this;return e>t?t===1?e:`${t} /
 ${e}`:t}case"matrix":if(this.matrix){const[e,t]=this.matrix;return`${e},${t}`}return"?";case"index":return this.id}if(!c(this.meta)&&c(h[this.meta.code]))return this.formatName(this.meta.name)},icon(){if(this.isShowingKeymapLegends&&this.meta&&h[this.meta.code])return h[this.meta.code]},isSelected(){return this.id===this.getSelectedKey&&!this.$store.state.keymap.selectedContent},isContentSelected(){return this.$store.state.keymap.selectedContent&&this.id===this.getSelectedKey},isShowingKeymapLegends(){return this.legends==="keymap"},myclasses(){let e=[];this.isSelected&&e.push("keycode-select"),this.inHover&&e.push("overme"),this.inSwap&&e.push("swapme"),this.meta&&this.meta.name.length>=2&&this.isShowingKeymapLegends&&e.push("smaller"),this.meta&&this.meta.code==="KC_NO"&&this.configuratorSettings.applyDisabledStyleForUnassigned&&e.push("disabled");const{KEY_WIDTH:t,KEY_HEIGHT:s}=this.config;return e.push(f(this.uh,this.uw)),!c(this.meta)&&!this.printable&&(this.colorwayOverride&&this.colorwayOverride[this.meta.code]?e.push(`${this.colorway}-${this.colorwayOverride[this.meta.code]}`):n.alphaCodes[this.meta.code]?e.push(`${this.colorway}-key`):n.modCodes[this.meta.code]||this.w<=t*3&&(this.w>t||this.h>s)?(e.push("mod"),e.push(`${this.colorway}-mod`)):e.push(`${this.colorway}-key`)),e.join(" ")},mystyles(){let e=[];return this.y>0&&e.push(`top: ${this.y}px;`),this.x>0&&e.push(`left: ${this.x}px;`),f(this.uh,this.uw)==="custom"&&(this.uw!==1&&e.push(`--unit-width: ${this.uw};`),this.uh!==1&&e.push(`--unit-height: ${this.uh};`)),e.join("")}},methods:{...p("keymap",["setSelected","setKeycode","swapKeys","setSelectedContent"]),...p("app",["stopListening","startListening"]),clicked(){let e=this.id;this.isSelected&&(e=void 0),this.setSelected(e)},dropped(e){this.setSelected(this.id);let t=JSON.parse(e.dataTransfer.getData("application/json"));t.action==="swap"?(console.log(`swapping ${t.id} with ${this.id}`),this.swapKeys({layer:this.curLayer,srcIndex:t.id,dstIndex:this.id})):this.setKeycode({_code:t.code,layer:t.layer}),this.dragleave()},dragend(){this.inSwap=!1,this.inHover=!1,this.$el.style.opacity="1"},dragover(){return!1},dragenter(){this.inHover=!0},dragleave(){this.inHover=!1},dragstart(e){this.inSwap=!0;let{id:t}=this;e.dropEffect="move",e.dataTransfer.dropEffect="move",e.dataTransfer.setData("application/json",JSON.stringify({action:"swap",id:t}))},formatName(e){return e},remove(){this.setSelected(this.id),this.setKeycode({_code:"KC_NO"})},clickContents(){let e=this.id;this.isContentSelected&&(e=void 0),this.setSelectedContent(e)}},data(){return{inHover:!1,inSwap:!1,platform:void 0}}},g={};var N=_(E,x,$,!1,b);function b(e){for(let t in g)this[t]=g[t]}const I=function(){return N.exports}();export{I as B,A as a};
